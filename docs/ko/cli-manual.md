# CLI 명령 매뉴얼

플러그인은 WP-CLI 서브 명령어를 지원합니다.
이 문서에서는 아래와 같이 명령한다고 가정합니다.

```shell
wp ttp <command>
```

현재 버전인 0.12.0에서는 아래와 같은 명령을 지원합니다.

- access-token
- add
- export
- import
- me
- remove
- reset
- run
- scrap
- status

## 서브 명령어

### Acess Token

등록된 OAUTH 엑세스 토큰을 출력합니다.

```shell
wp ttp access-token
```

출력 결과는 아래의 예와 같습니다.

```
Access Token: 
TH_VERY_LONG_TOKEN_STRING
User ID: 
1234567890123456
```

### Add

작업 큐에 태스크를 추가합니다.

**주의**: 태스크 이름은 시스템 상에서 특별한 규칙을 따릅니다. 임의의 태스크를 추가하지 마세요.

```
wp ttp add task_1 task_2 ...
```

태스크는 공백없는 하나이 문자열입니다. 공백으로 나누어 여러 태스크를 한번에 입력할 수도 있습니다.
태스크는 큐 내에서 유일한 문자열일 필요가 없습니다. 그러므로 큐에 같은 이름의 태스크가 얼마든지 중복되어 저장될 수 있습니다.

#### 옵션

`--prepend`: 태스크는 보통 큐의 가장 뒤에 저장되지만, 이 옵션을 사용하면 입력된 태스크는 모두 큐의 가장 앞에 저장됩니다.
여러 태스크가 이 스위치가 쓰인 경우에는 입력된 순서를 지켜서 큐의 선두에 저장됩니다. 예를 들어 기존의 큐에 이런 태스크가 있었다고 했을 때,

```
task_C
task_D
task_E
```

`wp ttp add task_A task_B`를 실행하면 아래처럼 큐에 쌓입니다.

```
task_C
task_D
task_E
task_A
task_B
```

`wp ttp add --prepend task_A task_B`를 실행하면 아래처럼 결과가 달라집니다.

```
task_A
task_B
task_C
task_D
task_E
```

### Export

태스크를 파일로 내보냅니다.

```shell
wp ttp export <file_name> 
```

파일 이름을 '-'로 입력하면 표준출력으로 출력합니다.
파일 형식은 단순한 텍스트 문서입니다. 한 줄에 하나씩 태스크가 기록되어 있습니다.

```
wp ttp export -
```

### Import

파일로 저장된 태스크를 불러옵니다.

```shell
wp ttp import <file_name>
```

파일 이름을 반드시 지정해야 합니다. 파일로부터 한줄씩 태스크를 읽어 큐에 저장합니다.
이 때 기존의 큐의 태스크는 삭제되지 않습니다.

#### 옵션

`--prepend` 기존 큐의 선두에 태스크를 배치합니다. 선두에 배치될 때 텍스트 파일에 나열된 태스크의 순서는 그대로 유지됩니다.

### Me

토큰을 발급 받은 주체의 정보를 추력합니다.
App ID와 App Secret을 정확히 입력하고 액세스 토큰을 받으면, 이 명령을 통해 결과를 검증할 수 있습니다.

```shell
wp ttp me
```

출력되는 결과는 아래의 예와 같습니다.

```json
{
  "id": "user-id-number",
  "username": "username-string",
  "name": "name-string",
  "threads_profile_picture_url": "https://scontent-ssn1-1.cdninstagram.com/profile_url",
  "threads_biography": "your-description-string"
}
```

### Remove

큐에 저장된 태스크를 삭제합니다.

```shell
wp ttp remove <task_index>...
```

태스크를 삭제할 때는 태스크의 이름이 아닌, 태스크가 큐에 위치한 **오프셋 인덱스**를 입력해야 합니다.
이 인덱스는 0부터 시작합니다.

오프셋 인덱스를 알아보려면 `wp ttp status` 명령을 사용하십시오.

여러 인덱스를 한번에 이력하여 한 번의 명령으로 삭제가 가능합니다. 다음처럼 사용할 수 있습니다.

```shell
wp ttp remove 3 5 8 # 오프셋을 공백으로 구분해 하나씩 입력
wp ttp remove -20   # 0번부터 20번까지 연속된 태스크 제거
wp ttp remove 55-   # 55번부터 마지막까지 연속된 태스크 제거
wp ttp remove 13-22 # 13번부터 22번까지 연속된 태스크 제거. 13번과 22번도 포함됩니다.

wp ttp remove -8 33 13-22 11 57- 44 # 한 번에. 입력시 인덱스 순서는 관계 없음.
                                    # 삭제되는 인덱스: 0-8 11 13~22 33 44 57~(끝)
wp ttp remove -                     # --all 옵션과 동일합니다.   
```

삭제된 태스크를 취소할 수 없으므로 삭제 전 주의하십시오.

#### 욥션

`--all`: 모든 옵션을 삭제합니다. 이 때 오프셋 인덱스도 같이 입력될 수는 있으나, 무시됩니다.

`--invert`: 입력된 오프셋에 해당하는 태스크를 지우는 것이 아니라, 지정된 인덱스의 태스크만 남기고 **나머지**를 모두 삭제합니다.

### Reset

큐를 초기화합니다.

큐의 모든 태스크가 삭제됩니다. 삭제된 후에는 작업을 취소할 수 없습니다.

```shell
wp ttp reset
```

리셋 전 Y/N 확인을 합니다. 이 때 'y'를 눌러야 초기화됩니다.

#### 옵션

`--yes`: 확인 절차를 거치지 않고 바로 초기화합니다.

### Run

큐에 적재된 태스크를 진행합니다.

**주의**: 태스크 이름은 시스템 상에서 특별한 규칙을 따릅니다. 임의의 태스크가 추가된 채 이 명령을 실행하지 마세요.

#### 옵션

`--forever`: 최대로 작업할 태스크의 갯수를 무한히 늘립니다. 즉, 큐가 빌 때까지 계속 진행시킵니다.
이 때 태스크 이름이 올바르지 못하다면 무한 루프에 빠질 수 있습니다. 사용에 주의하시기 바랍니다.

`--log_level=<log_level>`: 로그 출력 레벨을 조절합니다. `<log_level>`에 `debug`, `info`, `notice`, `warning`, `error`를 입력할 수 있습니다.
기본값은 `info`입니다.

`--max_task=<max_task>`: 최대로 작업할 태스크 수를 지정합니다. `<max_task>`에 양수를 입력합니다. 기본값은 25입니다.
만약 `--forever` 옵션이 사용되었다면, 이 옵션은 무시됩니다.

`--sleep=<sleep>`: 지정된 태스크는 스레드에 API 호출을 할 수 있습니다. 호출 후 반드시 `sleep()` 함수 호출로 잠시 호출 간격을 조절합니다,
양의 정수를 입력하합니다.  기본값은 2입니다.

### Scrap

스레드 포스트 스크랩을 준비합니다.

```shell
wp ttp scrap
```

이 명령을 내리면 큐는 초기화됩니다. 초기화 되기 전 사용자에게 Y/N 확인을 합니다. 이 때 'y'를 눌러야 진행됩니다.

스크랩은 가벼운(light) 모드와 무거운(heavy) 모드가 있습니다. 이에 관해서는 스크랩 문서를 참조하십시오.

이 명령은 큐를 초기화하고, 스크립을 진행하라는 태스크를 삽입할 뿐입니다. 실제 작업을 진행하려면 `run` 명령을 입력해야 합니다. 

#### 옵션

`--heavy`: 이 옵션이 없으면 가벼운(light) 모드, 있으면 무거운(heavy) 모드로 스크랩을 준비합니다.

`--yes`: 큐를 초기화하기 전에 Y/N 확인을 생략합니다.

### Status

큐의 상태를 보여줍니다.

```shell
wp ttp status
```

큐에 작업이 없을 때는 아래처럼 출력됩니다.

```
No tasks queued.
```

작업이 있을 때는 아래처럼 출력됩니다.

```
Tasks:
   0	task_A
   1	task_B
   2	task_C

Total 3 task(s).
```

태스크 이름 앞에 붙는 숫자 0, 1, 2는 태스크의 오프셋 인덱스입니다.
